default: &default
  styles:
    'timestamp': [ yellow, bold ]
    'file': [ blue, bold ]
    severity:
      debug: green
      info: green
      warn:  yellow
      error: red
      fatal: [ red, blink ]
      unknown: red
  formats:
    default: &default_format >
      {%lt%timestamp} {%5s%severity}
      "{%0.<%= ENV.fetch('COLUMNS', 80).to_i / 2 %>%message}"
      {location}
      {file}{-%O%backtrace}{-%O%meta}
    d: *default_format
    long: &long_format |
      timestamp: {%lt%timestamp}
      severity: {severity}
      message: "{message}"
      metric: {metric} {value} {type}
      error_class: {error_class}
      backtrace: {%O%backtrace}
      location: {location}
      file: {file}
      meta: {%O%meta}\n
    l: *long_format
    legacy: >
      {%0.1s%severity} [{%lt%timestamp} #{%d%pid}] {%5s%severity} --
      {program}: {message}
    metric: >
      {%ft%timestamp} {metric} {value} {type}

development:
  <<: *default
  config_files:
    rails:
      - log/development.log
    test:
      - log/test.log
    redis:
      - /usr/local/var/log/redis.log
    elasticsearch:
      - /usr/local/var/log/elasticsearch@1.7.log
    nginx:
      - /usr/local/var/log/nginx/access.log
      - /usr/local/var/log/nginx/error.log
  legacy_supported: <%= ENV['LOG_LEGACY_SUPPORTED'].to_i == 1 %>

test:
  <<: *default
  config_files:
    test:
      - log/test.log
  legacy_supported: <%= ENV['LOG_LEGACY_SUPPORTED'].to_i == 1 %>

production:
  <<: *default
  config_files:
    rails:
      - /var/apps/betterplace/current/log/production.log
    cron:
      - /var/apps/betterplace/current/log/cron.log
    nginx:
      - /var/apps/betterplace/current/log/nginx.assets.access.log
      - /var/apps/betterplace/current/log/nginx.assets.error.log
      - /var/apps/betterplace/current/log/nginx.betterplace.access.log
      - /var/apps/betterplace/current/log/nginx.betterplace.error.log
      - /var/apps/betterplace/current/log/nginx.default.access.log
      - /var/apps/betterplace/current/log/nginx.default.error.log
    memosig:
      - /var/log/memosig/current
    unicorn:
      - /var/log/unicorn/current
  legacy_supported: yes
